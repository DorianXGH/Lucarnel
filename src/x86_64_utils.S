BITS 64

section .text
global _lgdt
global _lidt

_lgdt:
    lgdt [rdi]
.reloadSegments:
   ; Reload CS register containing code selector:
    jmp   0x08:reload_CS ; 0x08 points at the new code selector
.reload_CS:
   ; Reload data segment registers:
    mov   ax, 0x10 ; 0x10 points at the new data selector
    mov   ds, ax
    mov   es, ax
    mov   fs, ax
    mov   gs, ax
    mov   ss, ax
    ret

_lidt:
    lidt [rdi]
    ret